{% comment %}
DO NOT EDIT THIS FILE!
IT IS MANAGED AUTOMATICALLY BY THE AGE CHECKER PLUS SHOPIFY APP!
CHANGES MADE TO THIS FILE WILL BE OVERWRITTEN DURING APP UPDATES!
LAST UPDATE Wed Oct 06 2021 14:41:56 GMT+0000
{% endcomment %}

{% unless age_checker_snippet_has_ran %}

    {% if content_for_header contains 'mG35tH2eGxRu7PQW' %}

        {% assign age_checker_installed = true %}

    {% else %}

        {% assign age_checker_installed = false %}

    {% endif %}

    {% if age_checker_installed != true %}

        {% assign age_checker_show = false %}

    {% elsif shop.metafields.agecheckerVsARddsz9.active != 'QFw7fWSBpVZDmWX9U7' %}

        {% assign age_checker_show = false %}

    
    {% elsif shop.metafields.agecheckerVsARddsz9.show_checker_on != 'certain_pages' %}

        {% assign age_checker_show = true %}

    {% elsif shop.metafields.agecheckerVsARddsz9.groups %}

        
        {% for group_pair in shop.metafields.agecheckerVsARddsz9.groups %}

            {% assign group = group_pair[1] %}

            {% assign age_checker_group_check = true %}

            {% for rule_pair in group %}

                {% assign rule = rule_pair[1] %}

                {% case rule.type %}

                    {% when 'template_type' %}

                        {% if rule.value == 'homepage' and template.name == 'index' %}

                            {% assign age_checker_rule_check = true %}

                        {% elsif rule.value == template.name %}

                            {% assign age_checker_rule_check = true %}

                        {% else %}

                            {% assign age_checker_rule_check = false %}

                        {% endif %}

                    {% when 'template' %}

                        {% if rule.value == template %}

                            {% assign age_checker_rule_check = true %}

                        {% else %}

                            {% assign age_checker_rule_check = false %}

                        {% endif %}

                    {% when 'product' %}

                        {% assign id = rule.value | plus: 0 %}
                        {% if id == product.id %}

                            {% assign age_checker_rule_check = true %}

                        {% else %}

                            {% assign age_checker_rule_check = false %}

                        {% endif %}

                    {% when 'page' %}

                        {% assign id = rule.value | plus: 0 %}
                        {% if id == page.id %}

                            {% assign age_checker_rule_check = true %}

                        {% else %}

                            {% assign age_checker_rule_check = false %}

                        {% endif %}

                    {% when 'article' %}

                        {% assign id = rule.value | plus: 0 %}
                        {% if id == article.id %}

                            {% assign age_checker_rule_check = true %}

                        {% else %}

                            {% assign age_checker_rule_check = false %}

                        {% endif %}

                    {% when 'collection' %}

                        {% assign id = rule.value | plus: 0 %}
                        {% if id == collection.id %}

                            {% assign age_checker_rule_check = true %}

                        {% else %}

                            {% assign age_checker_rule_check = false %}

                        {% endif %}

                    {% when 'tag' %}

                        {% assign age_checker_rule_check = false %}
                        {% for tag in product.tags %}
                            {% assign lower_case_value = rule.value | downcase %}
                            {% assign lower_case_tag = tag | downcase %}
                            {% if lower_case_value == lower_case_tag %}
                                {% assign age_checker_rule_check = true %}
                                {% break %}
                            {% endif %}
                        {% endfor %}

                    {% when 'layout' %}

                        {% assign age_checker_rule_check = false %}

                        {% case rule.value %}

                            {% when 'Password' %}

                                {% if request.page_type == 'password' %}

                                    {% assign age_checker_rule_check = true %}

                                {% endif %}

                        {% endcase %}

                {% endcase %}

                {% if age_checker_rule_check == true and rule.logic == 'equal' %}

                    {% assign age_checker_rule_check = true %}

                {% elsif age_checker_rule_check == false and rule.logic == 'not_equal' %}

                    {% assign age_checker_rule_check = true %}

                {% else %}

                    {% assign age_checker_rule_check = false %}

                {% endif %}

                {% if age_checker_rule_check == false %}

                    {% assign age_checker_group_check = false %}
                    {% break %}

                {% endif %}

            {% endfor %}

            {% if age_checker_group_check == true %}

                {% assign age_checker_show = true %}
                {% break %}

            {% endif %}

        {% endfor %}

    {% elsif template.name == 'index' %}

        
        {% assign age_checker_show = true %}

    {% else %}

        {% assign age_checker_show = false %}

    {% endif %}

    {% assign logo_image_end = shop.metafields.agecheckerVsARddsz9.logo_image.url | split: '/' | last %}
    {% if logo_image_end != blank %}
        {% assign logo_image_asset = logo_image_end | split: '?' | first %}
        {% assign logo_image_url = logo_image_asset | asset_img_url: '300x' %}
    {% endif %}

    {% assign modal_image_end = shop.metafields.agecheckerVsARddsz9.modal_image.url | split: '/' | last %}
    {% if modal_image_end != blank %}
        {% assign modal_image_asset = modal_image_end | split: '?' | first %}
        {% assign modal_image_url = modal_image_asset | asset_img_url: '800x' %}
    {% endif %}

    {% assign background_image_end = shop.metafields.agecheckerVsARddsz9.background_image.url | split: '/' | last %}
    {% if background_image_end != blank %}
        {% assign background_image_asset = background_image_end | split: '?' | first %}
        {% assign background_image_url = background_image_asset | asset_img_url: '2000x' %}
    {% endif %}

    {% if shop.metafields.agecheckerVsARddsz9.no_peek_mode == 'QFw7fWSBpVZDmWX9U7' %}

        {% assign background_color = shop.metafields.agecheckerVsARddsz9.background_color %}
        <div id="agp__noPeekScreen"
            {% if background_color != blank %}
                style="background: {{ background_color }};"
            {% endif %}
        ></div>

        <style>
            #agp__noPeekScreen {
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background-color: #3d4246;
                z-index: 100000000;
            }
        </style>

    {% endif %}

    <div id="agp__root"></div>

    <script>
        window.agecheckerVsARddsz9 = {
            fields: {{ shop.metafields.agecheckerVsARddsz9 | json }},
            images: {
                logo_image: '{{ logo_image_url }}',
                modal_image: '{{ modal_image_url }}',
                background_image: '{{ background_image_url }}',
            },
            callbacks: {},
            cartUrl: '{{ routes.cart_url }}',
            {% if product.id != blank %}
                product: {{ product | json }},
            {% endif %}
        };

        window.agecheckerVsARddsz9.removeNoPeekScreen = function() {
            var el = document.getElementById('agp__noPeekScreen');
            el && el.remove();
        };

        window.agecheckerVsARddsz9.getCookie = function(name) {
            const nameEQ = name + '=';
            const ca = document.cookie.split(';');
            for (let i = 0; i < ca.length; i++) {
                let c = ca[i];
                while (c.charAt(0) === ' ') c = c.substring(1, c.length);
                if (c.indexOf(nameEQ) === 0) return c.substring(nameEQ.length, c.length);
            }
            return null;
        };

        window.agechecker_developer_api = {
            on: function(eventName, callback) {
                if (!window.agecheckerVsARddsz9.callbacks[eventName]) {
                    window.agecheckerVsARddsz9.callbacks[eventName] = [];
                }
                window.agecheckerVsARddsz9.callbacks[eventName].push(callback);
            },
        };
    </script>

    {% if age_checker_show == true %}

        <script>
            window.agecheckerVsARddsz9.isPageMatch = true;

            if (window.agecheckerVsARddsz9.getCookie('__age_checker-history') === 'pass') {
                window.agecheckerVsARddsz9.isPageMatch = false;
            }
        </script>

    {% else %}

        <script>
            window.agecheckerVsARddsz9.isPageMatch = false;
        </script>

    {% endif %}

    <script>
        if (window.location.pathname === '/age-checker-preview') {
            window.agecheckerVsARddsz9.isPageMatch = true;
        }

        if (!window.agecheckerVsARddsz9.isPageMatch) {
            window.agecheckerVsARddsz9.removeNoPeekScreen();
        }
    </script>

    {% assign age_checker_snippet_has_ran = true %}

{% endunless %}
